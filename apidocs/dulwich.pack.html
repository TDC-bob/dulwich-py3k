<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>dulwich.pack : API documentation</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <link href="apidocs.css" type="text/css" rel="stylesheet" />
    
    
  </head>
  <body>
    <h1 class="module">d.pack : module documentation</h1>
    <p>
      <span id="part">Part of <a href="dulwich.html">dulwich</a></span>
      
      
    </p>
    <div>
      
    </div>
    <pre>Classes for dealing with packed git objects.

A pack is a compact representation of a bunch of objects, stored
using deltas where possible.

They have two parts, the pack file, which stores the data, and an index
that tells you where the data is.

To find an object you look in all of the index files 'til you find a
match for the object name. You then use the pointer got from this as
a pointer in to the corresponding packfile.</pre>

    
    
    <div id="splitTables">
      <table class="children sortable" id="id316">
  
  
<tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#take_msb_bytes">take_msb_bytes</a></td>
    <td><tt>Read bytes marked with most significant bit.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.UnpackedObject.html">UnpackedObject</a></td>
    <td><tt>Class encapsulating an object unpacked from a pack file.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#read_zlib_chunks">read_zlib_chunks</a></td>
    <td><tt>Read zlib data from a buffer.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#iter_sha1">iter_sha1</a></td>
    <td><tt>Return the hexdigest of the SHA1 over a set of names.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#load_pack_index">load_pack_index</a></td>
    <td><tt>Load an index file by path.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#load_pack_index_file">load_pack_index_file</a></td>
    <td><tt>Load an index file from a file-like object.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#bisect_find_sha">bisect_find_sha</a></td>
    <td><tt>Find a SHA in a data blob with sorted SHAs.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.PackIndex.html">PackIndex</a></td>
    <td><tt>An index in to a packfile.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.MemoryPackIndex.html">MemoryPackIndex</a></td>
    <td><tt>Pack index that is stored entirely in memory.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.FilePackIndex.html">FilePackIndex</a></td>
    <td><tt>Pack index that is based on a file.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.PackIndex1.html">PackIndex1</a></td>
    <td><tt>Version 1 Pack Index file.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.PackIndex2.html">PackIndex2</a></td>
    <td><tt>Version 2 Pack Index file.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#read_pack_header">read_pack_header</a></td>
    <td><tt>Read the header of a pack file.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#chunks_length">chunks_length</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#unpack_object">unpack_object</a></td>
    <td><tt>Unpack a Git object.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.PackStreamReader.html">PackStreamReader</a></td>
    <td><tt>Class to read a pack stream.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.PackStreamCopier.html">PackStreamCopier</a></td>
    <td><tt>Class to verify a pack stream as it is being read.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#obj_sha">obj_sha</a></td>
    <td><tt>Compute the SHA for a numeric type and object chunks.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#compute_file_sha">compute_file_sha</a></td>
    <td><tt>Hash a portion of a file into a new SHA.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.PackData.html">PackData</a></td>
    <td><tt>The data contained in a packfile.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.DeltaChainIterator.html">DeltaChainIterator</a></td>
    <td><tt>Abstract iterator over pack data based on delta chains.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.PackIndexer.html">PackIndexer</a></td>
    <td><tt>Delta chain iterator that yields index entries.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.PackInflater.html">PackInflater</a></td>
    <td><tt>Delta chain iterator that yields ShaFile objects.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.SHA1Reader.html">SHA1Reader</a></td>
    <td><tt>Wrapper around a file-like object that remembers the SHA1 of its data.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.SHA1Writer.html">SHA1Writer</a></td>
    <td><tt>Wrapper around a file-like object that remembers the SHA1 of its data.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#pack_object_header">pack_object_header</a></td>
    <td><tt>Create a pack object header for the given object info.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#write_pack_object">write_pack_object</a></td>
    <td><tt>Write pack object to a file.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#write_pack">write_pack</a></td>
    <td><tt>Write a new pack data file.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#write_pack_header">write_pack_header</a></td>
    <td><tt>Write a pack header for the given number of objects.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#deltify_pack_objects">deltify_pack_objects</a></td>
    <td><tt>Generate deltas for pack objects.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#write_pack_objects">write_pack_objects</a></td>
    <td><tt>Write a new pack data file.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#write_pack_data">write_pack_data</a></td>
    <td><tt>Write a new pack data file.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#write_pack_index_v1">write_pack_index_v1</a></td>
    <td><tt>Write a new pack index file.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#create_delta">create_delta</a></td>
    <td><tt>Use python difflib to work out how to transform base_buf to target_buf.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#apply_delta">apply_delta</a></td>
    <td><tt>Based on the similar function in git's patch-delta.c.</tt></td>
  </tr><tr class="function">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#write_pack_index_v2">write_pack_index_v2</a></td>
    <td><tt>Write a new pack index file.</tt></td>
  </tr><tr class="class">
    
    
    <td>Class</td>
    <td><a href="dulwich.pack.Pack.html">Pack</a></td>
    <td><tt>A Git pack object.</tt></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#_load_file_contents">_load_file_contents</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    
    <td>Function</td>
    <td><a href="dulwich.pack.html#_compute_object_size">_compute_object_size</a></td>
    <td><tt>Compute the size of a unresolved object for use with LRUSizeCache.</tt></td>
  </tr>
  
</table>
      
      
    </div>
    
    
    

    <div class="function">
  <a name="dulwich.pack.take_msb_bytes">
    
  </a>
  <a name="take_msb_bytes">
    
  </a>
  <div class="functionHeader">
    
    def
    take_msb_bytes(read, crc32=None):
    
  </div>
  <div class="functionBody">
    
    <pre>Read bytes marked with most significant bit.

:param read: Read function</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.read_zlib_chunks">
    
  </a>
  <a name="read_zlib_chunks">
    
  </a>
  <div class="functionHeader">
    
    def
    read_zlib_chunks(read_some, unpacked, include_comp=False, buffer_size=_ZLIB_BUFSIZE):
    
  </div>
  <div class="functionBody">
    
    <pre>Read zlib data from a buffer.

This function requires that the buffer have additional data following the
compressed data, which is guaranteed to be the case for git pack files.

:param read_some: Read function that returns at least one byte, but may
    return less than the requested size.
:param unpacked: An UnpackedObject to write result data to. If its crc32
    attr is not None, the CRC32 of the compressed bytes will be computed
    using this starting CRC32.
    After this function, will have the following attrs set:
    * comp_chunks    (if include_comp is True)
    * decomp_chunks
    * decomp_len
    * crc32
:param include_comp: If True, include compressed data in the result.
:param buffer_size: Size of the read buffer.
:return: Leftover unused data from the decompression.
:raise zlib.error: if a decompression error occurred.</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.iter_sha1">
    
  </a>
  <a name="iter_sha1">
    
  </a>
  <div class="functionHeader">
    
    def
    iter_sha1(iter):
    
  </div>
  <div class="functionBody">
    
    <pre>Return the hexdigest of the SHA1 over a set of names.

:param iter: Iterator over string objects
:return: 40-byte hex sha1 digest</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.load_pack_index">
    
  </a>
  <a name="load_pack_index">
    
  </a>
  <div class="functionHeader">
    
    def
    load_pack_index(path):
    
  </div>
  <div class="functionBody">
    
    <pre>Load an index file by path.

:param filename: Path to the index file
:return: A PackIndex loaded from the given path</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack._load_file_contents">
    
  </a>
  <a name="_load_file_contents">
    
  </a>
  <div class="functionHeader">
    
    def
    _load_file_contents(f, size=None):
    
  </div>
  <div class="functionBody">
    
    <div class="undocumented">Undocumented</div>
  </div>
</div><div class="function">
  <a name="dulwich.pack.load_pack_index_file">
    
  </a>
  <a name="load_pack_index_file">
    
  </a>
  <div class="functionHeader">
    
    def
    load_pack_index_file(path, f):
    
  </div>
  <div class="functionBody">
    
    <pre>Load an index file from a file-like object.

:param path: Path for the index file
:param f: File-like object
:return: A PackIndex loaded from the given file</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.bisect_find_sha">
    
  </a>
  <a name="bisect_find_sha">
    
  </a>
  <div class="functionHeader">
    
    def
    bisect_find_sha(start, end, sha, unpack_name):
    
  </div>
  <div class="functionBody">
    
    <pre>Find a SHA in a data blob with sorted SHAs.

:param start: Start index of range to search
:param end: End index of range to search
:param sha: Sha to find
:param unpack_name: Callback to retrieve SHA by index
:return: Index of the SHA, or None if it wasn't found</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.read_pack_header">
    
  </a>
  <a name="read_pack_header">
    
  </a>
  <div class="functionHeader">
    
    def
    read_pack_header(read):
    
  </div>
  <div class="functionBody">
    
    <pre>Read the header of a pack file.

:param read: Read function
:return: Tuple of (pack version, number of objects). If no data is available
    to read, returns (None, None).</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.chunks_length">
    
  </a>
  <a name="chunks_length">
    
  </a>
  <div class="functionHeader">
    
    def
    chunks_length(chunks):
    
  </div>
  <div class="functionBody">
    
    <div class="undocumented">Undocumented</div>
  </div>
</div><div class="function">
  <a name="dulwich.pack.unpack_object">
    
  </a>
  <a name="unpack_object">
    
  </a>
  <div class="functionHeader">
    
    def
    unpack_object(read_all, read_some=None, compute_crc32=False, include_comp=False, zlib_bufsize=_ZLIB_BUFSIZE):
    
  </div>
  <div class="functionBody">
    
    <pre>Unpack a Git object.

:param read_all: Read function that blocks until the number of requested
    bytes are read.
:param read_some: Read function that returns at least one byte, but may not
    return the number of bytes requested.
:param compute_crc32: If True, compute the CRC32 of the compressed data. If
    False, the returned CRC32 will be None.
:param include_comp: If True, include compressed data in the result.
:param zlib_bufsize: An optional buffer size for zlib operations.
:return: A tuple of (unpacked, unused), where unused is the unused data
    leftover from decompression, and unpacked in an UnpackedObject with
    the following attrs set:

    * obj_chunks     (for non-delta types)
    * pack_type_num
    * delta_base     (for delta types)
    * comp_chunks    (if include_comp is True)
    * decomp_chunks
    * decomp_len
    * crc32          (if compute_crc32 is True)</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack._compute_object_size">
    
  </a>
  <a name="_compute_object_size">
    
  </a>
  <div class="functionHeader">
    
    def
    _compute_object_size(no_tuple):
    
  </div>
  <div class="functionBody">
    
    <pre>Compute the size of a unresolved object for use with LRUSizeCache.</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.obj_sha">
    
  </a>
  <a name="obj_sha">
    
  </a>
  <div class="functionHeader">
    
    def
    obj_sha(type, chunks):
    
  </div>
  <div class="functionBody">
    
    <pre>Compute the SHA for a numeric type and object chunks.</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.compute_file_sha">
    
  </a>
  <a name="compute_file_sha">
    
  </a>
  <div class="functionHeader">
    
    def
    compute_file_sha(f, start_ofs=0, end_ofs=0, buffer_size=116):
    
  </div>
  <div class="functionBody">
    
    <pre>Hash a portion of a file into a new SHA.

:param f: A file-like object to read from that supports seek().
:param start_ofs: The offset in the file to start reading at.
:param end_ofs: The offset in the file to end reading at, relative to the
    end of the file.
:param buffer_size: A buffer size for reading.
:return: A new SHA object updated with data read from the file.</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.pack_object_header">
    
  </a>
  <a name="pack_object_header">
    
  </a>
  <div class="functionHeader">
    
    def
    pack_object_header(type_num, delta_base, size):
    
  </div>
  <div class="functionBody">
    
    <pre>Create a pack object header for the given object info.

:param type_num: Numeric type of the object.
:param delta_base: Delta base offset or ref, or None for whole objects.
:param size: Uncompressed object size.
:return: A header for a packed object.</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.write_pack_object">
    
  </a>
  <a name="write_pack_object">
    
  </a>
  <div class="functionHeader">
    
    def
    write_pack_object(f, type, object, sha=None):
    
  </div>
  <div class="functionBody">
    
    <pre>Write pack object to a file.

:param f: File to write to
:param type: Numeric type of the object
:param object: Object to write
:return: Tuple with offset at which the object was written, and crc32</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.write_pack">
    
  </a>
  <a name="write_pack">
    
  </a>
  <div class="functionHeader">
    
    def
    write_pack(filename, objects, num_objects=None):
    
  </div>
  <div class="functionBody">
    
    <pre>Write a new pack data file.

:param filename: Path to the new pack file (without .pack extension)
:param objects: Iterable of (object, path) tuples to write.
    Should provide __len__
:return: Tuple with checksum of pack file and index file</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.write_pack_header">
    
  </a>
  <a name="write_pack_header">
    
  </a>
  <div class="functionHeader">
    
    def
    write_pack_header(f, num_objects):
    
  </div>
  <div class="functionBody">
    
    <pre>Write a pack header for the given number of objects.</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.deltify_pack_objects">
    
  </a>
  <a name="deltify_pack_objects">
    
  </a>
  <div class="functionHeader">
    
    def
    deltify_pack_objects(objects, window=10):
    
  </div>
  <div class="functionBody">
    
    <pre>Generate deltas for pack objects.

:param objects: Objects to deltify
:param window: Window size
:return: Iterator over type_num, object id, delta_base, content
    delta_base is None for full text entries</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.write_pack_objects">
    
  </a>
  <a name="write_pack_objects">
    
  </a>
  <div class="functionHeader">
    
    def
    write_pack_objects(f, objects, window=10, num_objects=None):
    
  </div>
  <div class="functionBody">
    
    <pre>Write a new pack data file.

:param f: File to write to
:param objects: Iterable of (object, path) tuples to write.
    Should provide __len__
:param window: Sliding window size for searching for deltas; currently
               unimplemented
:param num_objects: Number of objects (do not use, deprecated)
:return: Dict mapping id -&gt; (offset, crc32 checksum), pack checksum</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.write_pack_data">
    
  </a>
  <a name="write_pack_data">
    
  </a>
  <div class="functionHeader">
    
    def
    write_pack_data(f, num_records, records):
    
  </div>
  <div class="functionBody">
    
    <pre>Write a new pack data file.

:param f: File to write to
:param num_records: Number of records
:param records: Iterator over type_num, object_id, delta_base, raw
:return: Dict mapping id -&gt; (offset, crc32 checksum), pack checksum</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.write_pack_index_v1">
    
  </a>
  <a name="write_pack_index_v1">
    
  </a>
  <div class="functionHeader">
    
    def
    write_pack_index_v1(f, entries, pack_checksum):
    
  </div>
  <div class="functionBody">
    
    <pre>Write a new pack index file.

:param f: A file-like object to write to
:param entries: List of tuples with object name (sha), offset_in_pack,
    and crc32_checksum.
:param pack_checksum: Checksum of the pack file.
:return: The SHA of the written index file</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.create_delta">
    
  </a>
  <a name="create_delta">
    
  </a>
  <div class="functionHeader">
    
    def
    create_delta(base_buf, target_buf):
    
  </div>
  <div class="functionBody">
    
    <pre>Use python difflib to work out how to transform base_buf to target_buf.

:param base_buf: Base buffer
:param target_buf: Target buffer</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.apply_delta">
    
  </a>
  <a name="apply_delta">
    
  </a>
  <div class="functionHeader">
    
    def
    apply_delta(src_buf, delta):
    
  </div>
  <div class="functionBody">
    
    <pre>Based on the similar function in git's patch-delta.c.

:param src_buf: Source buffer
:param delta: Delta instructions</pre>
  </div>
</div><div class="function">
  <a name="dulwich.pack.write_pack_index_v2">
    
  </a>
  <a name="write_pack_index_v2">
    
  </a>
  <div class="functionHeader">
    
    def
    write_pack_index_v2(f, entries, pack_checksum):
    
  </div>
  <div class="functionBody">
    
    <pre>Write a new pack index file.

:param f: File-like object to write to
:param entries: List of tuples with object name (sha), offset_in_pack, and
    crc32_checksum.
:param pack_checksum: Checksum of the pack file.
:return: The SHA of the index file written</pre>
  </div>
</div>
    <address>
      <a href="index.html">API Documentation</a> for <a href="http://samba.org/~jelmer/dulwich/">Dulwich</a>, generated by <a href="http://codespeak.net/~mwh/pydoctor/">pydoctor</a> at 2011-11-25 13:37:30.
    </address>
  </body>
</html>